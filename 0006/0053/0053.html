<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hung-yi Lee's Lectures(台大李宏毅老師系列課程)</title>
    <style>
        body {
            font-family: sans-serif;
            font-size: 18px;
            color: #111;
            padding: 0 0 1em 0;
        }
        .l {
          color: #050;
        }
        .s {
            display: inline-block;
        }
        .e {
            display: inline-block;
        }
        .t {
            display: inline-block;
        }
    </style>
  </head>
  <body>
    <a href="../../index.html">back to index</a>
    <h2>Network Compression (3/6)</h2><a href=https://www.youtube.com/watch?v=mzZzn8fBvEs><img src=https://i.ytimg.com/vi_webp/mzZzn8fBvEs/hqdefault.webp></a><br>
    
    <div class="c">
        <a class="l" href="#00:01.000" id=00:01.000>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=1">00:01.000</a></div>
        <div class="t">下一個要講的技術叫做知識分析。知識分析是什麼意思?知識分析是說,我們可以先訓練一個大的網絡,再訓練一個小的網絡,去學習大的網絡的行為。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:19.080" id=00:19.080>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=19">00:19.080</a></div>
        <div class="t">我們先訓練一個很大的網絡,然後把訓練的資料都丟到大的網絡裡面,那這個大的網絡會得到一些效果。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:27.560" id=00:27.560>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=27">00:27.560</a></div>
        <div class="t">但大的網絡的效果也不會完全是正確的。大的網絡的效果,他可能給他這張圖片,他覺得他有0.7的信心分數是1,0.2的信心分數是7,0.1的信心分數是9。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:43.520" id=00:43.520>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=43">00:43.520</a></div>
        <div class="t">他可能不會覺得說完全是1,因為他1跟7跟9長得有點像,所以他說他覺得很像是1,但也有一點點可能是7跟9。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:52.040" id=00:52.040>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=52">00:52.040</a></div>
        <div class="t">接下來,你用一個學生名稱,他是一個比較小的網絡,去模仿大的網絡的效果。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:58.360" id=00:58.360>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=58">00:58.360</a></div>
        <div class="t">也就是這個學生名稱,他不是跟正確的資料去學習,你並不是直接教學生名稱說這個是1,你不是這樣教他。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:07.600" id=01:07.600>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=67">01:07.600</a></div>
        <div class="t">你是告訴他說,你去看大的網絡的效果是什麼,你跟他的效果一模一樣的東西,就是學生名稱看到這張一樣的圖片,他要效果說他有70%的信心分數是1,20%的信心分數是7,10%的信心分數是9。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:23.400" id=01:23.400>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=83">01:23.400</a></div>
        <div class="t">過去人們相信說,或者在文件上也看到很多的例子是,小的網絡,學生名稱直接勸,勸不起來,他要跟著大的網絡去勸,才勸得起來。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:35.560" id=01:35.560>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=95">01:35.560</a></div>
        <div class="t">當然我們剛才有看到說,也有很多的反例,那這個都是目前仍然尚待研究的問題。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:41.880" id=01:41.880>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=101">01:41.880</a></div>
        <div class="t">不過在過去,人們相信,小的網絡勸不太起來,要勸大的網絡才可以。那你可以在文獻上找到這樣子的相關的技術跟討論。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:54.080" id=01:54.080>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=114">01:54.080</a></div>
        <div class="t">但是你在計算這個Cross Entropy的時候,你是計算兩個Distribution之間的Kailh Divergence,對不對,你要minimize兩個Distribution之間的Cross Entropy。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:20.240" id=02:20.240>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=140">02:20.240</a></div>
        <div class="t">那今天是在OneTard的Case,它只是一個Special Case。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:24.640" id=02:24.640>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=144">02:24.640</a></div>
        <div class="t">今天在這個Case,你當然也可以用Mean Square Error,但是你在這邊用Cross Entropy是完全沒有問題的,因為這邊也是一個Distribution,然後你希望你的Narrow Output的Distribution跟Teacher Output的Distribution越近越好,這樣希望有回答到你的問題。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:43.680" id=02:43.680>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=163">02:43.680</a></div>
        <div class="t">那我認為這邊應該是用Cross Entropy還是會比較好啦,用Mean Square Error,在你的Output是Sigmoid或者是Softmax的時候,是會有問題的這樣子。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:56.040" id=02:56.040>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=176">02:56.040</a></div>
        <div class="t">好,這樣大家這邊還有問題嗎?好,那這邊試圖用直觀的方法幫大家解釋一下說,為什麼Student跟著Teacher去學可能會有比較好的結果。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:12.480" id=03:12.480>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=192">03:12.480</a></div>
        <div class="t">那是因為Teacher其實提供了比Label Data更豐富的資料。舉例來說,在這個例子裡面,如果Student直接跟Label Data去學,他只會知道說這張圖片是1,但是老師在教Student的時候,他不只告訴他這張圖片是1,他還順便告訴你說1跟7長得很像,1跟9長得很像。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:38.240" id=03:38.240>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=218">03:38.240</a></div>
        <div class="t">所以今天Student跟老師學的時候,他學到的東西是更多的。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:43.920" id=03:43.920>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=223">03:43.920</a></div>
        <div class="t">那如果你看這個Knowledge Destination,Hinton寫的那篇Paper的話,他甚至可以做到神奇的事情是說,在訓練的時候,你可以把某些數字直接就Remove掉,比如說你從來沒有給Student看7這個數字,但是Student仍然可能可以正確地辨識7這個數字。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#04:06.800" id=04:06.800>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=246">04:06.800</a></div>
        <div class="t">為什麼?因為他在跟老師學的時候,學過說7長得跟1很像,他也學過說7長得跟9很像,所以到時候,雖然在訓練的時候,他從來沒有看過7這個數字,但是訓練的時候有7進來,他可能也可以得到正確的辨識結果。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#04:23.640" id=04:23.640>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=263">04:23.640</a></div>
        <div class="t">那Knowledge Destination一個有用的地方是說,我們今天在做Machine Learning的時候,你往往會做Ensemble,大家都知道說如果是打Cargo比賽的話,最終的大絕招我們都要做什麼?就是瘋狂的Ensemble。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#04:40.800" id=04:40.800>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=280">04:40.800</a></div>
        <div class="t">最後比的就是,誰Ensemble比較多Model就贏了,別人用8個,你用16個,你就贏了,別人用16個,你就用32個,你就贏了,所以最後就是比說誰Ensemble比較多的Model。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#04:56.340" id=04:56.340>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=296">04:56.340</a></div>
        <div class="t">但是這種Ensemble,雖然你可以在Cargo的比賽上進步一些,但是在實作上、在實用上是沒有效率的,因為你說你train了一千個Model,進步了1%,那又怎樣呢?你真的能夠在你的device上面放一千個Model嗎?你真的能在testing的時候跑過一千個Model嗎?</div>
    </div>
    
    <div class="c">
        <a class="l" href="#05:15.480" id=05:15.480>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=315">05:15.480</a></div>
        <div class="t">所以Knowledge Destination一個有用的地方是,它可以把你Ensemble的Model統統併起來,變成一個Model。也就是你現在,你在做Ensemble這件事,你有一大堆的Network,你會把這些Network的output做平均,得到一個答案。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#05:30.340" id=05:30.340>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=330">05:30.340</a></div>
        <div class="t">接下來,你讓你的Student去學這個Ensemble的Network的output,你希望你的Student的Network的output跟Ensemble的結果一樣,那你就可以把Ensemble這個東西讓Student學起來,到時候你只需要一個Model,它就可以達到類似Ensemble的效果,它就可以達到Ensemble的Performance。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#05:53.400" id=05:53.400>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=353">05:53.400</a></div>
        <div class="t">好,那這是Knowledge Destination的一個妙用。然後在實作上呢,在實作Knowledge Destination的時候,有一個常用的Trick就是,一般我們在做Classify的時候,你最後會有一個Softmax的Layer嘛,那Softmax的Layer是怎麼實作的呢?</div>
    </div>
    
    <div class="c">
        <a class="l" href="#06:09.680" id=06:09.680>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=369">06:09.680</a></div>
        <div class="t">就是你會把你的Network Output的值,假設Network現在在最後一層Output的值叫做X,你會把X取Exponential,再做Normalize,得到最終的輸出Y。那這個呢,我們之前課堂已經講過很多遍了,我們就不要再重複,你會做這個是Softmax。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#06:28.720" id=06:28.720>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=388">06:28.720</a></div>
        <div class="t">那在做Knowledge Destination的時候,你在取Exponential之前,你可以把你這些值都除一個大T,這個大T叫做Temperature,它通常是一個大於1的值。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#06:43.400" id=06:43.400>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=403">06:43.400</a></div>
        <div class="t">那除這個Temperature有什麼用呢?我們就舉一個例子,假設你現在的X有三個分別是110跟1,你做完Softmax以後,你得到的結果,Y1是1,Y2跟Y3都是十個負十幾次方,就跟0是一樣的。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#07:01.280" id=07:01.280>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=421">07:01.280</a></div>
        <div class="t">那我們說這種Knowledge Destination的方法會有用,是因為你的Teacher告訴Student更多的訊息,他告訴你說1跟7很像,但是你不希望說你的Student,你的Teacher的Output跟One-half是一樣的,跟Label Data是一樣的。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#07:16.480" id=07:16.480>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=436">07:16.480</a></div>
        <div class="t">如果你的Teacher只會Output說某一個Label是1,其他都是0,那其實就跟Label Data學,直接跟正確答案學是一樣的。所以我們為了讓Teacher Output Distribution可以更輕易地讓Student學到,</div>
    </div>
    
    <div class="c">
        <a class="l" href="#07:34.400" id=07:34.400>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=454">07:34.400</a></div>
        <div class="t">所以你會讓不同的Label間的分數拉近一點。那怎麼讓不同的Label間的分數拉近一點呢?你就是除上這個Temperature,那這邊假設我們Temperature是100,</div>
    </div>
    
    <div class="c">
        <a class="l" href="#07:47.400" id=07:47.400>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=467">07:47.400</a></div>
        <div class="t">所以本來X1、X2、X3分別是110,那除掉100以後就變成1、0.1、0.01。那再做Softmax,再過Softmax以後得到的值就是0.56、0.23、0.21,Y1它的值仍然是最大的。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#08:01.960" id=08:01.960>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=481">08:01.960</a></div>
        <div class="t">那這個時候Student就會知道說,那Y2跟Y3也有一些值,讓Student跟Teacher去學的時候就會跟真正的Data學不一樣。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#08:11.600" id=08:11.600>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=491">08:11.600</a></div>
        <div class="t">那這個T就是一個參數,這個參數是你需要去調一下的。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#08:17.360" id=08:17.360>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=mzZzn8fBvEs&t=497">08:17.360</a></div>
        <div class="t">那在實作上,還有在我們的作業上,助教自己實作的結果發現Noise Desolation沒有特別有用,就這樣子。</div>
    </div>
    
</body>
</html>   