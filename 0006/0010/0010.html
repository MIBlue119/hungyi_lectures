<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hung-yi Lee's Lectures(台大李宏毅老師系列課程)</title>
    <style>
        body {
            font-family: sans-serif;
            font-size: 18px;
            color: #111;
            padding: 0 0 1em 0;
        }
        .l {
          color: #050;
        }
        .s {
            display: inline-block;
        }
        .e {
            display: inline-block;
        }
        .t {
            display: inline-block;
        }
    </style>
  </head>
  <body>
    <a href="../../index.html">back to index</a>
    <h2>Attack ML Models (3/8)</h2><a href=https://www.youtube.com/watch?v=F9N5zF7N0qY><img src=https://i.ytimg.com/vi_webp/F9N5zF7N0qY/hqdefault.webp></a><br>
    
    <div class="c">
        <a class="l" href="#00:01.000" id=00:01.000>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=1">00:01.000</a></div>
        <div class="t">在剛才的投影片中呢,我們定義了Loss function L,然後呢我們定義了Distance D。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:08.760" id=00:08.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=8">00:08.760</a></div>
        <div class="t">那我們現在要做的事情,是解一個Optimization的Problem,我們要找一個X',這個X'可以讓L of X' 值越小越好,</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:21.760" id=00:21.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=21">00:21.760</a></div>
        <div class="t">但是同時這個X'要滿足一個限制,它跟X0的差距不可以太大。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:29.760" id=00:29.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=29">00:29.760</a></div>
        <div class="t">那這一個可以讓L越小越好,同時又滿足這個限制的X',我們這邊寫做X'.</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:38.760" id=00:38.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=38">00:38.760</a></div>
        <div class="t">那要怎麼找這個X'呢?其實你找這個X'的方法,跟你一般在train一個Neural Network其實是非常像的。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:47.760" id=00:47.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=47">00:47.760</a></div>
        <div class="t">我們一般在train一個Neural Network的時候,我們是要找一個Network Parameter Setup,去minimize某一個Loss function。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#00:55.760" id=00:55.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=55">00:55.760</a></div>
        <div class="t">我們現在只是改成,我們要找一張新的Image X',這個新的Image X'可以minimize某一個Loss function。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:04.760" id=01:04.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=64">01:04.760</a></div>
        <div class="t">那你怎麼會說,啊不對啊,這邊有一個限制,這跟一般的train Network的過程不太一樣。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:12.760" id=01:12.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=72">01:12.760</a></div>
        <div class="t">那沒關係,我們現在先把這個限制拿掉。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:16.760" id=01:16.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=76">01:16.760</a></div>
        <div class="t">如果我們把這個限制拿掉,那你其實就會解了,你可以用Gradient Descent,只是你把你現在的X'當作Network的參數來看待。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:25.760" id=01:25.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=85">01:25.760</a></div>
        <div class="t">就之前我們在訓練Network的時候,我們是調這個參數去minimize Loss function,現在我們把X'當作Network的參數。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:33.760" id=01:33.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=93">01:33.760</a></div>
        <div class="t">但是Network原來真正的參數是固定的,是不動的,我們只調X',用Gradient Descent的方法來調X',找到一個可以讓Loss最小的X'.</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:43.760" id=01:43.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=103">01:43.760</a></div>
        <div class="t">怎麼做?就用Gradient Descent。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:46.760" id=01:46.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=106">01:46.760</a></div>
        <div class="t">那這個就是Gradient Descent的algorithm,那我們知道說,如果你要apply Gradient Descent,你要先initialize你要找的參數。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#01:55.760" id=01:55.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=115">01:55.760</a></div>
        <div class="t">那在原來的Neural Network裡面,你會random initialize你的Network parameter。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:00.760" id=02:00.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=120">02:00.760</a></div>
        <div class="t">在這邊,我們說,我們可以把原來的Image X'當作我們的initialized point。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:08.760" id=02:08.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=128">02:08.760</a></div>
        <div class="t">然後接下來,我們就用Gradient Descent的方法,去update我們的X。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:13.760" id=02:13.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=133">02:13.760</a></div>
        <div class="t">在每一個iteration裡面,我們就先算出Xt-1,這三個iteration得到的Xt-1對Loss的Gradient。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:24.760" id=02:24.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=144">02:24.760</a></div>
        <div class="t">然後再乘上learning rate,然後再把Xt-1減掉learning rate,乘上Gradient,得到新的Xt。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:33.760" id=02:33.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=153">02:33.760</a></div>
        <div class="t">然後就把這個process反覆大提示,那這個Gradient這個倒三角形是什麼意思呢?</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:39.760" id=02:39.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=159">02:39.760</a></div>
        <div class="t">我們就不需要再細講,我想在這個有關Gradient Descent的錄音裡面,都已經講得非常清楚了。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:46.760" id=02:46.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=166">02:46.760</a></div>
        <div class="t">好,那接下來呢,我們就把我們剛才說我們不知道怎麼處理的那個限制呢,把它加回去。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#02:54.760" id=02:54.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=174">02:54.760</a></div>
        <div class="t">我們說,我們要找的X'不只可以minimize這個Loss function,這個X'跟X0的距離不可以超過Epsilon。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:02.760" id=03:02.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=182">03:02.760</a></div>
        <div class="t">所以我們需要一個改版的Gradient Descent,怎麼做?</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:08.760" id=03:08.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=188">03:08.760</a></div>
        <div class="t">因為我們今天一般在做Gradient Descent的時候,你對這個X並沒有任何限制。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:13.760" id=03:13.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=193">03:13.760</a></div>
        <div class="t">所以有可能你跑了大T的iteration以後,你的X會跟X0差很多,它不滿足你這邊這個限制的這個條件。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:22.760" id=03:22.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=202">03:22.760</a></div>
        <div class="t">所以怎麼辦?我們要修改一下我們的演算法。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:27.760" id=03:27.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=207">03:27.760</a></div>
        <div class="t">我們在每一個iteration裡面呢,我們都去check說這個Xt有沒有符合我們的限制。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:34.760" id=03:34.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=214">03:34.760</a></div>
        <div class="t">如果Xt沒有符合我們的限制,也就是說Xt跟X0的距離大過Epsilon的話,那我們就進行一個修正。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:42.760" id=03:42.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=222">03:42.760</a></div>
        <div class="t">這個修正目標是要修改Xt,讓Xt跟X0的距離小於等於我們的限制Epsilon。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#03:53.760" id=03:53.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=233">03:53.760</a></div>
        <div class="t">那怎麼做修改這件事呢?你可以想像說你寫了一個function,這個function叫做fix。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#04:01.760" id=04:01.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=241">04:01.760</a></div>
        <div class="t">那fix這個function實際上做的事情就是,它重舉所有跟X0距離在Epsilon以內的所有的X。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#04:11.760" id=04:11.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=251">04:11.760</a></div>
        <div class="t">再看這些符合限制的X,它跟我們現在不符合限制的Xt哪一個最接近?</div>
    </div>
    
    <div class="c">
        <a class="l" href="#04:17.760" id=04:17.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=257">04:17.760</a></div>
        <div class="t">我們看哪一個符合限制的X跟不符合限制的Xt最接近,就用這個符合限制的X來取代Xt,結束。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#04:26.760" id=04:26.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=266">04:26.760</a></div>
        <div class="t">實際上你是怎麼寫這個function的呢?如果你今天用的是L2 node,那你的X0在這中間,然後你希望你找到的X,它跟X0的距離都不可以超過Epsilon。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#04:39.760" id=04:39.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=279">04:39.760</a></div>
        <div class="t">所以你找到的X一定要落在以X0為原心半徑式Epsilon的這個圈圈裡面,你找到的所有X都應該要落在這個圈圈裡面。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#04:51.760" id=04:51.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=291">04:51.760</a></div>
        <div class="t">那我們今天如果做完Gradient Descent,做一次update,發現說今天Xt跑出這個圈圈範圍外了,那怎麼辦?</div>
    </div>
    
    <div class="c">
        <a class="l" href="#05:01.760" id=05:01.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=301">05:01.760</a></div>
        <div class="t">你就把它抓回來,你就看說今天在這個圈圈範圍內,哪一個點跟Xt的距離最近,就用那個點來取代Xt。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#05:11.760" id=05:11.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=311">05:11.760</a></div>
        <div class="t">實際上在寫這個程式的時候非常容易,你就把X0跟Xt連起來,然後看這條線通過這個圓的哪一個點,那那個點就是離Xt最近,但同時又在這個圓圈內的X。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#05:31.760" id=05:31.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=331">05:31.760</a></div>
        <div class="t">反正如果是L infinity的話也是一樣,如果是L infinity的話,你的X0在中間,然後你今天不管是往左邊走,往右邊走,往上面走,往下面走,你都不可以走超出Epsilon的距離。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#05:49.760" id=05:49.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=349">05:49.760</a></div>
        <div class="t">所以以這個X0為圓心,這個方形的範圍是你可以接受的範圍,你要在這個方形的範圍內去找一個X line,它可以optimize你的loss function,它可以minimize你的loss function。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#06:07.760" id=06:07.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=367">06:07.760</a></div>
        <div class="t">但是今天如果你用Brady-Desai的演算法,一update你的X發現說它跳出了這個方形的區域,那怎麼辦?當你update你的參數發現它跳出了這個方形的區域,那你就把它拉回來。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#06:22.760" id=06:22.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=382">06:22.760</a></div>
        <div class="t">那今天拉回來的方法非常簡單,就看說這個Xt如果它是在Y軸的這個方向超過了Epsilon,那就把它設為Epsilon,在X軸的方向超過了Epsilon,就把它設為Epsilon,那就把這個Xt拉進這個方形的範圍來就結束了。</div>
    </div>
    
    <div class="c">
        <a class="l" href="#06:42.760" id=06:42.760>link</a> |
        <div class="s"><a href="https://www.youtube.com/watch?v=F9N5zF7N0qY&t=402">06:42.760</a></div>
        <div class="t">那這個在神社的實作上都是非常簡單的。</div>
    </div>
    
</body>
</html>   